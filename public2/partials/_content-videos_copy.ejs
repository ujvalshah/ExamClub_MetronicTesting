<% include ./_subheader-subheader-v2 %>

<!-- Large Screens -->
<div class="kt-container  kt-grid__item kt-grid__item--fluid">
  <!-- <div class="container"> -->
  <!--begin::Portlet-->
  <div class="kt-portlet shadow" data-ktportlet="true" id="kt_portlet_tools_4">
    <div class="kt-portlet__head">
      <div class="kt-portlet__head-label">
        <h3 class="kt-portlet__head-title">
          Filter/Videos
        </h3>
      </div>
      <div class="kt-portlet__head-toolbar">
        <div class="kt-portlet__head-group">
          <a href="#" data-ktportlet-tool="toggle" class="btn btn-sm btn-icon btn-danger btn-icon-md"><i
              class="la la-angle-down"></i></a>
        </div>
      </div>
    </div>
    <div class="kt-portlet__body">

      <!------------------------------------------------------------------------------------------------------------
        -----------------------------------------------Filter Form Begin----------------------------------------------
        ------------------------------------------------------------------------------------------------------------->

      <form class="form-inline float-right my-2 my-lg-0 ml-auto" id='videoTable_filter_ajax' action="/videoscopy"
        method="GET" onsubmit="return filter()">

        <div class="row">
          <div class="col-md-3">
            <input class="form-control mr-sm-2 mb-3" id="search-video"
              style="width:100%; background:rgba(55,74,251,0.1)" type="search" placeholder="Search Videos..."
              name="search" aria-label="Search" value="">
          </div>
          <div class="col-md-3">
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <label class="input-group-text" for="videoGroupSelect01">Exam</label>
              </div>
              <select class="custom-select videoGroupSelect" id="exam" name="exam[]" onchange="return filter()">
                <option class="choose-video" disabled <%= !videoquery.exam ? "selected" : "" %>>Choose...</option>
                <option value="All">All</option>
                <option value="rf" <%= videoquery.exam && videoquery.exam.includes("rf") ? "selected" : "" %>>Remove
                  Filter
                </option>
                <option value="CA Final(New)"
                  <%= videoquery.exam && videoquery.exam.includes("CA Final(New)") ? "selected" : "" %>>CA Final(New)
                </option>
                <option value="CA Final(Old)"
                  <%= videoquery.exam && videoquery.exam.includes("CA Final(Old)") ? "selected" : "" %>>CA Final(Old)
                </option>
                <option value="CA Intermediate(New)"
                  <%= videoquery.exam && videoquery.exam.includes("CA Intermediate(New)") ? "selected" : "" %>>CA
                  Intermediate(New)</option>
                <option value="CA IPCC(Old)"
                  <%= videoquery.exam && videoquery.exam.includes("CA IPCC(Old)") ? "selected" : "" %>>CA IPCC(Old)
                </option>
                <option value="CA Foundation(New)"
                  <%= videoquery.exam && videoquery.exam.includes("CA Foundation(New)") ? "selected" : "" %>>CA
                  Foundation(New)
                </option>
              </select>
            </div>
          </div>
          <div class="col-md-3">
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <label class="input-group-text" for="videoGroupSelect02">Attempt</label>
              </div>
              <select class="custom-select videoGroupSelect" id="attempt" name="attempt[]" onchange="return filter()">
                <option disabled <%= !videoquery.attempt ? "selected" : "" %>>Choose...</option>
                <option value="All">All</option>
                <option value="rf" <%= videoquery.attempt && videoquery.attempt.includes("rf") ? "selected" : "" %>>
                  Remove
                  Filter</option>
                <option value="Nov 2019"
                  <%= videoquery.attempt && videoquery.attempt.includes("Nov 2019") ? "selected" : "" %>>
                  Nov 2019</option>
                <option value="May 2020"
                  <%= videoquery.attempt && videoquery.attempt.includes("May 2020") ? "selected" : "" %>>
                  May 2020</option>
                <option value="Nov 2020"
                  <%= videoquery.attempt && videoquery.attempt.includes("Nov 2020") ? "selected" : "" %>>
                  Nov 2020</option>
                <option value="May 2021"
                  <%= videoquery.attempt && videoquery.attempt.includes("May 2021") ? "selected" : "" %>>
                  May 2021</option>
                <option value="Nov 2021"
                  <%= videoquery.attempt && videoquery.attempt.includes("Nov 2021") ? "selected" : "" %>>
                  Nov 2021</option>
              </select>
            </div>
          </div>
          <div class="col-md-3">
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <label class="input-group-text" for="videoGroupSelect03">Author</label>
              </div>
              <select class="custom-select videoGroupSelect" id="videoGroupSelect03" onchange="return filter()">
                <option>Choose...</option>
                <option value="1">One</option>
                <option value="2">Two</option>
                <option value="3">Three</option>
              </select>
            </div>
          </div>
          <div class="col-md-3">
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <label class="input-group-text" for="videoGroupSelect04">Option</label>
              </div>
              <select class="custom-select videoGroupSelect" id="videoGroupSelect04">
                <option>Choose...</option>
                <option value="1">One</option>
                <option value="2">Two</option>
                <option value="3">Three</option>
              </select>
            </div>
          </div>

          <div class="col-md-3">
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <label class="input-group-text" for="videoGroupSelect05">Subject</label>
              </div>
              <select class="custom-select videoGroupSelect" id="subject" name="subject[]" onchange="return filter()">
                <option <%= !videoquery.subject ? "selected" : "" %> disabled>Choose...</option>
                <option value="All">All</option>
                <option value="rf" <%= videoquery.subject && videoquery.subject.includes("rf") ? "selected" : "" %>>
                  Remove
                  Filter</option>
                <option value="CA Final - P1: Financial Reporting"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P1: Financial Reporting") ? "selected" : "" %>>
                  P1:Financial Reporting</option>
                <option value="CA Final - P2: Strategic Financial Management"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P2: Strategic Financial Management") ? "selected" : "" %>>
                  P2:Strategic Financial Management</option>
                <option value="CA Final - P3: Advanced Auditing and Professional Ethics"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P3: Advanced Auditing and Professional Ethics") ? "selected" : "" %>>
                  P3:Advanced Auditing and Professional Ethics</option>
                <option value="CA Final - P4: Corporate & Economic Laws"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P4: Corporate & Economic Laws") ? "selected" : "" %>>
                  P4:Corporate & Economic Laws</option>
                <option value="CA Final - P5: Strategic Cost Management and Performance Evaluation"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P5: Strategic Cost Management and Performance Evaluation") ? "selected" : "" %>>
                  P5:Strategic Cost Management and Performance Evaluation</option>
                <option value="CA Final - P6A: Risk Management"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P6A: Risk Management") ? "selected" : "" %>>
                  P6A:Risk Management</option>
                <option value="CA Final - P6B: Financial Services & Capital Markets"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P6B: Financial Services & Capital Markets") ? "selected" : "" %>>
                  P6B:Financial Services & Capital Markets</option>
                <option value="CA Final - P6C: International Taxation"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P6C: International Taxation") ? "selected" : "" %>>
                  P6C:International Taxation</option>
                <option value="CA Final - P6E: Global Financial Reporting Standards"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P6E: Global Financial Reporting Standards") ? "selected" : "" %>>
                  P6E:Global Financial Reporting Standards</option>
                <option value="CA Final - P6F: Multi-disciplinary Case Study"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P6F: Multi-disciplinary Case Study") ? "selected" : "" %>>
                  P6F:Multi-disciplinary Case Study</option>
                <option value="CA Final - P7: Direct Tax Laws & International Taxation"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P7: Direct Tax Laws & International Taxation") ? "selected" : "" %>>
                  P7:Direct Tax Laws & International Taxation</option>
                <option value="CA Final - P8: Indirect Tax Laws"
                  <%= videoquery.subject && videoquery.subject.includes("CA Final - P8: Indirect Tax Laws") ? "selected" : "" %>>
                  P8:Indirect Tax Law</option>
              </select>
            </div>
          </div>
          <div class="col-md-3">
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <label class="input-group-text" for="videoGroupSelect06" onchange="return filter()">Topic</label>
              </div>
              <select class="custom-select videoGroupSelect" id="videoGroupSelect06" onchange="return filter()">
                <option>Choose...</option>
                <option value="1">One</option>
                <option value="2">Two</option>
                <option value="3">Three</option>
              </select>
            </div>
          </div>
          <div class="col-md-3">
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <label class="input-group-text" for="videoGroupSelect07">Subtopic</label>
              </div>
              <select class="custom-select videoGroupSelect" id="videoGroupSelect07">
                <option>Choose...</option>

              </select>
            </div>
          </div>
        </div>
        <div class="row d-flex justify-content-end" style="width:100%">
          <!-- <button type="submit" class="btn btn-label-success btn-bold mr-4" id='submit-video-form'>Submit</button> -->
          <a class="btn btn-label-danger btn-bold" href="/videoscopy" id="clear-video-form">Clear All Filters</a>
        </div>
        <!----------------------------Filter Tags---------------------------------------->
        <div class='row mt-3'>
          <div class="col">
            <div class="kt-section__content kt-section__content--solid">
              <span>Filter Tags: </span>
              <div id='videos-filter-tags' class="d-inline">
                <!-- <span class="btn btn-label-warning">Primary</span> -->
              </div>
            </div>
          </div>
        </div>
    </div>
  </div>

  <!-------------------------------------------------------------------------------->
  <!----------------------------Video Table----------------------------------------->
  <!-------------------------------------------------------------------------------->
  <!--begin: Pagination(sm)-->
  <div class="kt-grid__item kt-grid__item--fluid mt-5">
    <div class="kt-pagination kt-pagination--sm kt-pagination--brand my-3">
      <ul class="kt-pagination__links">
        <li class="kt-pagination__link--first">
          <a href="<%=paginateUrl%>page=1"><i class="fa fa-angle-double-left kt-font-brand"></i></a>
        </li>

        <li class="kt-pagination__link--next">
          <a href="<%=paginateUrl%>page=<%=videos.page-1%>"><i class="fa fa-angle-left kt-font-brand"></i></a>
        </li>
        <div class="d-flex" id='pagination-videos'>
          <%if(videos.pages>=1 && videos.docs.length){%>
          <% for(let i=1; i<=videos.pages; i++ ) {%>
          <li id="video-pagination_<%=i%>" class=<%= videos.page === i ? "kt-pagination__link--active" : "" %>>
            <a id="video-pagination-url_<%=i%>" href="<%=paginateUrl%>page=<%=i%>"><%=i%></a>
          </li>
          <%}%>
            <%}%>
        </div>

        <li class="kt-pagination__link--prev">
          <a href="<%=paginateUrl%>page=<%=videos.page+1%>"><i class="fa fa-angle-right kt-font-brand"></i></a>
        </li>

        <li class="kt-pagination__link--last">
          <a href="<%=paginateUrl%>page=<%=videos.pages%>"><i class="fa fa-angle-double-right kt-font-brand"></i></a>
        </li>
      </ul>
      <div class="kt-pagination__toolbar">
        <div class="mr-3">
          <!-- <form id="sorting-videoTable-form" method="GET" action="#"> -->
          <select class="form-control kt-font-brand" id="sorting-videoTable" name="sort" onchange="return filter()">
            <option disabled <%= !videoquery.exam ? "selected" : "" %>>Sort</option>
            <option value="-createdAt" <%= videoquery.sort && videoquery.sort==="-createdAt" ? "selected" : "" %>>
              Lastest Uploads
            </option>
            <option value="createdAt" <%= videoquery.sort && videoquery.sort==="createdAt" ? "selected" : "" %>>
              Earliest
              Uploads
            </option>
            <option value="-description" <%= videoquery.sort && videoquery.sort==="-description" ? "selected" : "" %>>
              Description-Asc
            </option>
            <option value="description" <%= videoquery.sort && videoquery.sort==="description" ? "selected" : "" %>>
              Description-Desc</option>
          </select>
          <!-- </form> -->
        </div>

        <!-- <form id="limit-videoTable-form" method="GET" action="<%=limitUrl%>"> -->
        <select class="form-control kt-font-brand" id="limit-videoTable" name="limit" style="width: 60px;"
          onchange="return filter()">
          <option value='1' <%= !videoquery.limit || videoquery.limit==="1" ? "selected" : "" %>>1</option>
          <option value='2' <%= !videoquery.limit || videoquery.limit==="2" ? "selected" : "" %>>2</option>
          <option value='10' <%= !videoquery.limit || videoquery.limit==="10" ? "selected" : "" %>>10</option>
          <option value='20' <%= videoquery.limit && videoquery.limit==="20" ? "selected" : "" %>>20</option>
          <option value='30' <%= videoquery.limit && videoquery.limit==="30" ? "selected" : "" %>>30</option>
          <option value='50' <%= videoquery.limit && videoquery.limit==="40" ? "selected" : "" %>>50</option>
        </select>
        <!-- </form> -->
        </form>
        <span class="pagination__desc">
          Showing 1 to <%= videos.limit%> of <%=videos.total%>
        </span>
      </div>
    </div>
  </div>
  <!--end: Pagination-->

  <!-- ------------------------------------------------------------------------------- -->
  <!-- ------------------------------Filter Form Ends--------------------------------- -->
  <!-- ------------------------------------------------------------------------------- -->

  <div class="kt-grid__item">
    <div style="background-color: white" class='shadow mb-5'>
      <div class="row px-4 py-5" id='videoLoop'>
        <%videos.docs.forEach(function(video){%>
        <div class="col-md-4 mb-3">
          <!--begin:: Widgets/Blog-->
          <div class="kt-portlet kt-portlet--height-fluid kt-widget19 mx-2 shadow">
            <div class="kt-portlet__body kt-portlet__body--fit kt-portlet__body--unfill">
              <div class="kt-widget19__pic kt-portlet-fit--top kt-portlet-fit--sides">
                <div class="embed-responsive embed-responsive-16by9 card-img-top">
                  <iframe width="560" height="315" class="embed-responsive-item" src="<%=video.url%>" frameborder="0"
                    allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen></iframe>
                </div>
                <!-- <iframe width="560" height="315" class="embed-responsive-item" src="https://www.youtube.com/watch?v=FobusV1Lmgg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> -->
                <!-- <h3 class="kt-widget19__title kt-font-dark pb-0 mb-0">
                Introducing New Feature
              </h3> -->
                <!-- <div class="kt-widget19__shadow"></div>
              <div class="kt-widget19__labels">
                <a href="#" class="btn btn-label-light-o2 btn-bold ">Recent</a>
              </div> -->
              </div>
            </div>
            <div class="kt-portlet__body">
              <div class="kt-widget19__wrapper mb-0">
                <h5 class="kt-widget19__title kt-font-dark kt-label-font-color-3 pb-2 mb-0">
                  <%if(video.type && video.type === 'playlist'){%>
                  <span title="This is a playlist"
                    class="kt-badge kt-badge--danger kt-badge--md kt-badge--rounded">P</span>
                  <%}%> <%=video.title%>
                </h5>
                <div class="kt-divider"><span></span></div>
                <div class="kt-widget19__content mt-2">
                  <div class="kt-widget19__userpic">
                    <span
                      class="kt-badge kt-badge--username kt-badge--unified-success kt-badge--lg kt-badge--bold kt-hidden-"><%=video.author.username.charAt(0).toUpperCase()%></span>
                    <!-- <img src="./assets/media//users/user1.jpg" alt=""> -->
                  </div>
                  <div class="kt-widget19__info">
                    <a href="/teachers/<%=video.author.id%>" class="kt-widget19__username">
                      <%=video.author.username%>
                    </a>
                    <span class="kt-widget19__time small">
                      CA Faculty/Author
                    </span>
                  </div>
                  <span class="kt-badge kt-badge--info kt-badge--inline float-right" data-toggle="tooltip"
                    data-placement="left" title="Date of Upload"><%=video.createdAt.toDateString()%></span>
                  <!-- <div class="kt-widget19__stats">
              <span class="kt-widget19__number kt-font-brand" style="font-size: 0.9rem">
              </span>
              <div class="float-right"> Applicable Attempt </div>
            </div> -->
                </div>
                <div class="mb-3 small font-weight-bold"> Applicable: <span
                    class="kt-badge kt-badge--danger kt-badge--inline kt-badge--pill kt-badge--bold"
                    data-toggle="tooltip" data-placement="bottom" title="Applicable Exam"><%=video.exam%></span>
                  <span class="kt-badge kt-badge--success kt-badge--inline kt-badge--pill kt-badge--bold"
                    data-toggle="tooltip" data-placement="bottom" title="Applicaple Attempt"><%=video.attempt%></span>
                </div>
                <div><small><span class="font-weight-bold">Description:</span> <%=video.description%></small></div>
                <div class="kt-widget19__text mb-2">
                </div>
              </div>
              <div class="kt-divider"><span></span></div>
              <div class="kt-widget19__action">
                <!--Ownership Criteria of Videos-->
                <% if(currentUser && (currentUser.isFaculty || currentUser.isAdmin) && (JSON.stringify(currentUser._id) === JSON.stringify(video.author.id))) {%>
                <div class="float-right align-bottom">
                  <a class="btn btn-sm btn-label-brand btn-bold ml-4" href="/videos/<%=video._id %>/edit"
                    role="button">Edit</a>delete
                  <form class="d-inline-block delete-video-form" action="/videos/<%=video._id%>?_method=DELETE"
                    method="POST" onsubmit="return deleteFacultyVideo(event,this)">
                    <button type="submit" class="btn btn-sm btn-label-danger btn-bold ml-1">Delete</button>
                  </form>
                </div>
                <%}else if(currentUser && currentUser.isStudent){%>
                <div class="float-right">
                  <form id="save-video-form" class="d-inline float-right"
                    action="/user/<%=currentUser._id%>/videos/<%=video._id%>?_method=PUT" method="POST"
                    onsubmit='return bookmarkVideo(event, this)'>
                    <button type="submit"
                      class="btn btn-sm ml-1 <%=currentUser.videoBookmarks.includes(video.id) ? "btn-info": "btn-warning" %>">
                      <%=currentUser.videoBookmarks.includes(video.id) ? "Bookmarked" : "Bookmark?" %></button>
                  </form>
                </div>
                <%} else if(!currentUser){%>
                <div class="float-right">
                  <form id=" bookmarkForm_<%=video._id %>" class="d-inline float-right save-video-form-signup"
                    action="javascript:;" onsubmit='return bookmarkVideosignup(event, this)'>
                    <button type="submit" class="btn btn-sm btn-warning btn-bold student-alert">Bookmark</button>
                  </form>
                </div>
                <%}%>
            </div>
          </div>
        </div>
        <!--end:: Widgets/Blog-->
    </div>
    <%})%>
              </div>
            </div>

  </div>
  <!--begin: Pagination-Bottom(sm)-->
  <div class="kt-grid__item kt-grid__item--fluid">
    <div class="kt-pagination kt-pagination--sm kt-pagination--brand mb-5">
      <ul class="kt-pagination__links">
        <li class="kt-pagination__link--first">
          <a href="<%=paginateUrl%>page=1"><i class="fa fa-angle-double-left kt-font-brand"></i></a>
        </li>

        <li class="kt-pagination__link--next">
          <a href="<%=paginateUrl%>page=<%=videos.page-1%>"><i class="fa fa-angle-left kt-font-brand"></i></a>
        </li>
        <div class="d-flex" id='pagination-videos_bottom'>
          <%if(videos.pages>=1 && videos.docs.length){%>
          <% for(let i=1; i<=videos.pages; i++ ) {%>
          <li id="video-pagination_<%=i%>_bottom"
            class=<%= videos.page === i ? "kt-pagination__link--active" : "" %>>
            <a id="video-pagination-url_<%=i%>_bottom" href="<%=paginateUrl%>page=<%=i%>"><%=i%></a>
          </li>
          <%}%>
      <%}%>
        </div>

        <li class="kt-pagination__link--prev">
          <a href="<%=paginateUrl%>page=<%=videos.page+1%>"><i class="fa fa-angle-right kt-font-brand"></i></a>
        </li>

        <li class="kt-pagination__link--last">
          <a href="<%=paginateUrl%>page=<%=videos.pages%>"><i
              class="fa fa-angle-double-right kt-font-brand"></i></a>
        </li>
      </ul>
    </div>
  </div>
  <!--end: Pagination-->
</div>

<!-- Small Screens
<div class="kt-container  kt-grid__item kt-grid__item--fluid d-block d-md-none">
Hello
</div> -->